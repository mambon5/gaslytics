<VirtualHost *:80>
    ServerName gaslytics.nescolam.com

    ProxyPreserveHost On
    ProxyRequests Off

    # WebSocket de Streamlit (per HTTP es ws://)
    ProxyPass /_stcore/stream ws://127.0.0.1:8501/_stcore/stream
    ProxyPassReverse /_stcore/stream ws://127.0.0.1:8501/_stcore/stream

    # Resta del tràfic via HTTP normal cap a Streamlit
    ProxyPass / http://127.0.0.1:8501/ retry=0
    ProxyPassReverse / http://127.0.0.1:8501/

    # Si vols permetre explícitament proxy cap a aquest backend:
    <Proxy "http://127.0.0.1:8501/">
        Require all granted
    </Proxy>

    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Forwarded-Port "80"

    ErrorLog ${APACHE_LOG_DIR}/gaslytics-error.log
    CustomLog ${APACHE_LOG_DIR}/gaslytics-access.log combined
</VirtualHost>
